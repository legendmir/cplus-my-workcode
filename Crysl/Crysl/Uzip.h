#pragma once
#include<windows.h>

const char* pUzipTab = "\x10\x04\x03\x00\x00\x06\x30\x00\x00\x05\x4C\x00\x10\x06\x08\x00\x00\x05\x20\x00\x00\x06\x47\x00\x00\x05\x54\x00\x00\x07\x37\x00\x10\x04\x04\x00\x00\x06\x35\x00\x00\x05\x52\x00\x12\x06\x17\x00\x00\x05\x45\x00\x00\x06\x55\x00\x11\x05\x0B\x00\x13\x07\x23\x00\x10\x04\x03\x00\x00\x06\x32\x00\x00\x05\x4F\x00\x11\x06\x0D\x00\x00\x05\x41\x00\x00\x06\x4E\x00\x10\x05\x05\x00\x00\x07\x59\x00\x10\x04\x04\x00\x00\x06\x43\x00\x00\x05\x53\x00\x00\x07\x29\x00\x00\x05\x49\x00\x10\x06\x06\x00\x12\x05\x13\x00\x00\x08\x57\x00\x10\x04\x03\x00\x00\x06\x31\x00\x00\x05\x4C\x00\x10\x06\x09\x00\x00\x05\x20\x00\x00\x06\x4D\x00\x00\x05\x54\x00\x00\x07\x39\x00\x10\x04\x04\x00\x00\x06\x42\x00\x00\x05\x52\x00\x12\x06\x1B\x00\x00\x05\x45\x00\x00\x06\x5F\x00\x11\x05\x0B\x00\x00\x08\x28\x00\x10\x04\x03\x00\x00\x06\x34\x00\x00\x05\x4F\x00\x11\x06\x0F\x00\x00\x05\x41\x00\x00\x06\x50\x00\x10\x05\x05\x00\x11\x07\x11\x00\x10\x04\x04\x00\x00\x06\x44\x00\x00\x05\x53\x00\x00\x07\x33\x00\x00\x05\x49\x00\x10\x06\x07\x00\x12\x05\x13\x00\x00\x09\x5A\x00\x10\x04\x03\x00\x00\x06\x30\x00\x00\x05\x4C\x00\x10\x06\x08\x00\x00\x05\x20\x00\x00\x06\x47\x00\x00\x05\x54\x00\x00\x07\x38\x00\x10\x04\x04\x00\x00\x06\x35\x00\x00\x05\x52\x00\x12\x06\x17\x00\x00\x05\x45\x00\x00\x06\x55\x00\x11\x05\x0B\x00\x00\x08\x0A\x00\x10\x04\x03\x00\x00\x06\x32\x00\x00\x05\x4F\x00\x11\x06\x0D\x00\x00\x05\x41\x00\x00\x06\x4E\x00\x10\x05\x05\x00\x10\x07\x0A\x00\x10\x04\x04\x00\x00\x06\x43\x00\x00\x05\x53\x00\x00\x07\x2C\x00\x00\x05\x49\x00\x10\x06\x06\x00\x12\x05\x13\x00\x13\x08\x33\x00\x10\x04\x03\x00\x00\x06\x31\x00\x00\x05\x4C\x00\x10\x06\x09\x00\x00\x05\x20\x00\x00\x06\x4D\x00\x00\x05\x54\x00\x00\x07\x46\x00\x10\x04\x04\x00\x00\x06\x42\x00\x00\x05\x52\x00\x12\x06\x1B\x00\x00\x05\x45\x00\x00\x06\x5F\x00\x11\x05\x0B\x00\x00\x08\x51\x00\x10\x04\x03\x00\x00\x06\x34\x00\x00\x05\x4F\x00\x11\x06\x0F\x00\x00\x05\x41\x00\x00\x06\x50\x00\x10\x05\x05\x00\x12\x07\x1F\x00\x10\x04\x04\x00\x00\x06\x44\x00\x00\x05\x53\x00\x00\x07\x36\x00\x00\x05\x49\x00\x10\x06\x07\x00\x12\x05\x13\x00\x14\x09\x43\x00\x10\x04\x03\x00\x00\x06\x30\x00\x00\x05\x4C\x00\x10\x06\x08\x00\x00\x05\x20\x00\x00\x06\x47\x00\x00\x05\x54\x00\x00\x07\x37\x00\x10\x04\x04\x00\x00\x06\x35\x00\x00\x05\x52\x00\x12\x06\x17\x00\x00\x05\x45\x00\x00\x06\x55\x00\x11\x05\x0B\x00\x13\x07\x23\x00\x10\x04\x03\x00\x00\x06\x32\x00\x00\x05\x4F\x00\x11\x06\x0D\x00\x00\x05\x41\x00\x00\x06\x4E\x00\x10\x05\x05\x00\x00\x07\x59\x00\x10\x04\x04\x00\x00\x06\x43\x00\x00\x05\x53\x00\x00\x07\x29\x00\x00\x05\x49\x00\x10\x06\x06\x00\x12\x05\x13\x00\x00\x08\x58\x00\x10\x04\x03\x00\x00\x06\x31\x00\x00\x05\x4C\x00\x10\x06\x09\x00\x00\x05\x20\x00\x00\x06\x4D\x00\x00\x05\x54\x00\x00\x07\x39\x00\x10\x04\x04\x00\x00\x06\x42\x00\x00\x05\x52\x00\x12\x06\x1B\x00\x00\x05\x45\x00\x00\x06\x5F\x00\x11\x05\x0B\x00\x00\x08\x48\x00\x10\x04\x03\x00\x00\x06\x34\x00\x00\x05\x4F\x00\x11\x06\x0F\x00\x00\x05\x41\x00\x00\x06\x50\x00\x10\x05\x05\x00\x11\x07\x11\x00\x10\x04\x04\x00\x00\x06\x44\x00\x00\x05\x53\x00\x00\x07\x33\x00\x00\x05\x49\x00\x10\x06\x07\x00\x12\x05\x13\x00\x00\x09\x64\x00\x10\x04\x03\x00\x00\x06\x30\x00\x00\x05\x4C\x00\x10\x06\x08\x00\x00\x05\x20\x00\x00\x06\x47\x00\x00\x05\x54\x00\x00\x07\x38\x00\x10\x04\x04\x00\x00\x06\x35\x00\x00\x05\x52\x00\x12\x06\x17\x00\x00\x05\x45\x00\x00\x06\x55\x00\x11\x05\x0B\x00\x00\x08\x27\x00\x10\x04\x03\x00\x00\x06\x32\x00\x00\x05\x4F\x00\x11\x06\x0D\x00\x00\x05\x41\x00\x00\x06\x4E\x00\x10\x05\x05\x00\x10\x07\x0A\x00\x10\x04\x04\x00\x00\x06\x43\x00\x00\x05\x53\x00\x00\x07\x2C\x00\x00\x05\x49\x00\x10\x06\x06\x00\x12\x05\x13\x00\x00\x09\x2E\x00\x10\x04\x03\x00\x00\x06\x31\x00\x00\x05\x4C\x00\x10\x06\x09\x00\x00\x05\x20\x00\x00\x06\x4D\x00\x00\x05\x54\x00\x00\x07\x46\x00\x10\x04\x04\x00\x00\x06\x42\x00\x00\x05\x52\x00\x12\x06\x1B\x00\x00\x05\x45\x00\x00\x06\x5F\x00\x11\x05\x0B\x00\x00\x08\x56\x00\x10\x04\x03\x00\x00\x06\x34\x00\x00\x05\x4F\x00\x11\x06\x0F\x00\x00\x05\x41\x00\x00\x06\x50\x00\x10\x05\x05\x00\x12\x07\x1F\x00\x10\x04\x04\x00\x00\x06\x44\x00\x00\x05\x53\x00\x00\x07\x36\x00\x00\x05\x49\x00\x10\x06\x07\x00\x12\x05\x13\x00\x01\x09\x02\x02\x10\x04\x03\x00\x00\x06\x30\x00\x00\x05\x4C\x00\x10\x06\x08\x00\x00\x05\x20\x00\x00\x06\x47\x00\x00\x05\x54\x00\x00\x07\x37\x00\x10\x04\x04\x00\x00\x06\x35\x00\x00\x05\x52\x00\x12\x06\x17\x00\x00\x05\x45\x00\x00\x06\x55\x00\x11\x05\x0B\x00\x13\x07\x23\x00\x10\x04\x03\x00\x00\x06\x32\x00\x00\x05\x4F\x00\x11\x06\x0D\x00\x00\x05\x41\x00\x00\x06\x4E\x00\x10\x05\x05\x00\x00\x07\x59\x00\x10\x04\x04\x00\x00\x06\x43\x00\x00\x05\x53\x00\x00\x07\x29\x00\x00\x05\x49\x00\x10\x06\x06\x00\x12\x05\x13\x00\x00\x08\x57\x00\x10\x04\x03\x00\x00\x06\x31\x00\x00\x05\x4C\x00\x10\x06\x09\x00\x00\x05\x20\x00\x00\x06\x4D\x00\x00\x05\x54\x00\x00\x07\x39\x00\x10\x04\x04\x00\x00\x06\x42\x00\x00\x05\x52\x00\x12\x06\x1B\x00\x00\x05\x45\x00\x00\x06\x5F\x00\x11\x05\x0B\x00\x00\x08\x28\x00\x10\x04\x03\x00\x00\x06\x34\x00\x00\x05\x4F\x00\x11\x06\x0F\x00\x00\x05\x41\x00\x00\x06\x50\x00\x10\x05\x05\x00\x11\x07\x11\x00\x10\x04\x04\x00\x00\x06\x44\x00\x00\x05\x53\x00\x00\x07\x33\x00\x00\x05\x49\x00\x10\x06\x07\x00\x12\x05\x13\x00\x00\x09\x63\x00\x10\x04\x03\x00\x00\x06\x30\x00\x00\x05\x4C\x00\x10\x06\x08\x00\x00\x05\x20\x00\x00\x06\x47\x00\x00\x05\x54\x00\x00\x07\x38\x00\x10\x04\x04\x00\x00\x06\x35\x00\x00\x05\x52\x00\x12\x06\x17\x00\x00\x05\x45\x00\x00\x06\x55\x00\x11\x05\x0B\x00\x00\x08\x0A\x00\x10\x04\x03\x00\x00\x06\x32\x00\x00\x05\x4F\x00\x11\x06\x0D\x00\x00\x05\x41\x00\x00\x06\x4E\x00\x10\x05\x05\x00\x10\x07\x0A\x00\x10\x04\x04\x00\x00\x06\x43\x00\x00\x05\x53\x00\x00\x07\x2C\x00\x00\x05\x49\x00\x10\x06\x06\x00\x12\x05\x13\x00\x13\x08\x33\x00\x10\x04\x03\x00\x00\x06\x31\x00\x00\x05\x4C\x00\x10\x06\x09\x00\x00\x05\x20\x00\x00\x06\x4D\x00\x00\x05\x54\x00\x00\x07\x46\x00\x10\x04\x04\x00\x00\x06\x42\x00\x00\x05\x52\x00\x12\x06\x1B\x00\x00\x05\x45\x00\x00\x06\x5F\x00\x11\x05\x0B\x00\x00\x08\x51\x00\x10\x04\x03\x00\x00\x06\x34\x00\x00\x05\x4F\x00\x11\x06\x0F\x00\x00\x05\x41\x00\x00\x06\x50\x00\x10\x05\x05\x00\x12\x07\x1F\x00\x10\x04\x04\x00\x00\x06\x44\x00\x00\x05\x53\x00\x00\x07\x36\x00\x00\x05\x49\x00\x10\x06\x07\x00\x12\x05\x13\x00\x01\x09\x00\x02\x10\x04\x03\x00\x00\x06\x30\x00\x00\x05\x4C\x00\x10\x06\x08\x00\x00\x05\x20\x00\x00\x06\x47\x00\x00\x05\x54\x00\x00\x07\x37\x00\x10\x04\x04\x00\x00\x06\x35\x00\x00\x05\x52\x00\x12\x06\x17\x00\x00\x05\x45\x00\x00\x06\x55\x00\x11\x05\x0B\x00\x13\x07\x23\x00\x10\x04\x03\x00\x00\x06\x32\x00\x00\x05\x4F\x00\x11\x06\x0D\x00\x00\x05\x41\x00\x00\x06\x4E\x00\x10\x05\x05\x00\x00\x07\x59\x00\x10\x04\x04\x00\x00\x06\x43\x00\x00\x05\x53\x00\x00\x07\x29\x00\x00\x05\x49\x00\x10\x06\x06\x00\x12\x05\x13\x00\x00\x08\x58\x00\x10\x04\x03\x00\x00\x06\x31\x00\x00\x05\x4C\x00\x10\x06\x09\x00\x00\x05\x20\x00\x00\x06\x4D\x00\x00\x05\x54\x00\x00\x07\x39\x00\x10\x04\x04\x00\x00\x06\x42\x00\x00\x05\x52\x00\x12\x06\x1B\x00\x00\x05\x45\x00\x00\x06\x5F\x00\x11\x05\x0B\x00\x00\x08\x48\x00\x10\x04\x03\x00\x00\x06\x34\x00\x00\x05\x4F\x00\x11\x06\x0F\x00\x00\x05\x41\x00\x00\x06\x50\x00\x10\x05\x05\x00\x11\x07\x11\x00\x10\x04\x04\x00\x00\x06\x44\x00\x00\x05\x53\x00\x00\x07\x33\x00\x00\x05\x49\x00\x10\x06\x07\x00\x12\x05\x13\x00\x00\x09\x65\x00\x10\x04\x03\x00\x00\x06\x30\x00\x00\x05\x4C\x00\x10\x06\x08\x00\x00\x05\x20\x00\x00\x06\x47\x00\x00\x05\x54\x00\x00\x07\x38\x00\x10\x04\x04\x00\x00\x06\x35\x00\x00\x05\x52\x00\x12\x06\x17\x00\x00\x05\x45\x00\x00\x06\x55\x00\x11\x05\x0B\x00\x00\x08\x27\x00\x10\x04\x03\x00\x00\x06\x32\x00\x00\x05\x4F\x00\x11\x06\x0D\x00\x00\x05\x41\x00\x00\x06\x4E\x00\x10\x05\x05\x00\x10\x07\x0A\x00\x10\x04\x04\x00\x00\x06\x43\x00\x00\x05\x53\x00\x00\x07\x2C\x00\x00\x05\x49\x00\x10\x06\x06\x00\x12\x05\x13\x00\x00\x09\x4B\x00\x10\x04\x03\x00\x00\x06\x31\x00\x00\x05\x4C\x00\x10\x06\x09\x00\x00\x05\x20\x00\x00\x06\x4D\x00\x00\x05\x54\x00\x00\x07\x46\x00\x10\x04\x04\x00\x00\x06\x42\x00\x00\x05\x52\x00\x12\x06\x1B\x00\x00\x05\x45\x00\x00\x06\x5F\x00\x11\x05\x0B\x00\x00\x08\x56\x00\x10\x04\x03\x00\x00\x06\x34\x00\x00\x05\x4F\x00\x11\x06\x0F\x00\x00\x05\x41\x00\x00\x06\x50\x00\x10\x05\x05\x00\x12\x07\x1F\x00\x10\x04\x04\x00\x00\x06\x44\x00\x00\x05\x53\x00\x00\x07\x36\x00\x00\x05\x49\x00\x10\x06\x07\x00\x12\x05\x13\x00\x01\x09\x04\x02\x00\x01\x4A\x00\x00\x01\x62\x00\x00\x01\x66\x00\x60\x01\x00\x00\x13\x01\x3B\x00\x14\x01\x53\x00\x13\x04\x11\x00\x17\x04\x01\x01\x15\x04\x41\x00\x19\x04\x01\x04\x14\x04\x21\x00\x18\x04\x01\x02\x16\x04\x81\x00\x19\x05\x01\x06\x13\x04\x19\x00\x17\x04\x81\x01\x15\x04\x61\x00\x1A\x04\x01\x08\x14\x04\x31\x00\x18\x04\x01\x03\x16\x04\xC1\x00\x12\x06\x09\x00\x13\x04\x11\x00\x17\x04\x01\x01\x15\x04\x41\x00\x19\x04\x01\x04\x14\x04\x21\x00\x18\x04\x01\x02\x16\x04\x81\x00\x1A\x05\x01\x0C\x13\x04\x19\x00\x17\x04\x81\x01\x15\x04\x61\x00\x1A\x04\x01\x08\x14\x04\x31\x00\x18\x04\x01\x03\x16\x04\xC1\x00\x01\x06\x40\x00\x13\x04\x11\x00\x17\x04\x01\x01\x15\x04\x41\x00\x19\x04\x01\x04\x14\x04\x21\x00\x18\x04\x01\x02\x16\x04\x81\x00\x19\x05\x01\x06\x13\x04\x19\x00\x17\x04\x81\x01\x15\x04\x61\x00\x1A\x04\x01\x08\x14\x04\x31\x00\x18\x04\x01\x03\x16\x04\xC1\x00\x1B\x06\x01\x10\x13\x04\x11\x00\x17\x04\x01\x01\x15\x04\x41\x00\x19\x04\x01\x04\x14\x04\x21\x00\x18\x04\x01\x02\x16\x04\x81\x00\x1A\x05\x01\x0C\x13\x04\x19\x00\x17\x04\x81\x01\x15\x04\x61\x00\x1A\x04\x01\x08\x14\x04\x31\x00\x18\x04\x01\x03\x16\x04\xC1\x00\x03\x06\x42\x00\x11\x01\x05\x00\x11\x01\x07\x00\x12\x01\x0D\x00\x1B\x02\x01\x18\x12\x01\x0D\x00\x10\x03\x01\x00\x12\x01\x0D\x00\x1B\x02\x01\x18\x12\x01\x0D\x00\x10\x03\x04\x00";




WORD pTab[20] =/* "\x0010\x0011\x0012\x0000\x0008\x0007\x0009\x0006\x000A\x0005\x000B\x0004\x000C\x0003\x000D\x0002\x000E\x0001\x000F\x0000"*/
{0x10,0x11,0x12,0x00,0x08,0x07,0x09,0x06,0x0a,0x05,0x0b,0x04,0x0c,0x03,0x0d,0x02,0x0e,0x01,0x0f,0x00};

struct ss {
	int label;
	int s4;
	int s14;
	int s24;
	char* s4c;
	int s54;
	int s5c;
	int s60;
	int s64;
	int s68;
	WORD s70[0x1000];
};

ss s;

void inits()
{
	s.label = 0xc;
	s.s14 = 0x8000;
	s.s24 = 0xf;
	s.s4c = new char[0x8000]{};
}

void Decompression(const char* psrc,int cnt)
{
	int edi = 0;
	int ebx = 0;
	int eax = 0;

	while (edi < 3)
	{
		if (cnt == 0)
		{
			return;
		}
		cnt--;
		byte a = *psrc;
		int t = (int)a;
		t <<= edi;
		ebx += t;
		edi += 8;
		psrc++;
	}
	s.s4= ebx & 1;
	ebx >>= 1;
	eax = ebx;
	eax &= 3;
	if (eax == 2)
	{
		s.label = 0xf;
		ebx >>= 2;
		edi -= 3;
		while (edi < 0xe)
		{
			if (cnt == 0)
			{
				return;
			}
			cnt--;
			byte a = *psrc;
			int t = (int)a;
			t <<= edi;
			ebx += t;
			edi += 8;
			psrc++;
		}
		eax = ebx;
		eax &= 0x1f;
		eax += 0x101;
		s.s60 = eax;
		ebx >>= 0x5;
		eax = ebx;
		eax &= 0x1f;
		eax += 1;
		ebx >>= 5;
		s.s64 = eax;
		eax = ebx;
		eax &= 0xf;
		eax += 4;
		ebx >>= 4;
		edi -= 0xe;
		s.s5c = eax;
		
		s.s68 &= 0;
		s.label = 0x10;
	}
}


